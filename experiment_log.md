# 概要
コードの分析結果やメモを記録

# 履歴
# 分析内容 Ver2.0
## 実施内容
- 4つのCSVの統合
- event_typeをワンホットエンコーディング
- 各特徴量の分布を確認

## 今後の予定
- データの前処理（特徴量）
- KMeans法を用いてクラスタリングを実施
- LightGBM、ランダムフォレストなどでClick・Purchseそれぞれの行動予測を実施

クラスタリング、行動予測はユーザー属性を示す特徴量、広告属性を示す特徴量、ユーザー・広告属性を統合した特徴量による3パターンを実施。
また、ユーザーセグメントｘ広告セグメントによる行動予測も実施予定

## 分析結果 Ver2.0
特徴量の分布は下記の通り
- 性別はやや男性寄り
- 年齢は20代がピーク。40代以上は少数
- 曜日による傾向さは見られない
- 国はアメリカ・イギリスが上位
- 広告タイプはストーリーズがやや多めだが、カルーセル・イメージ・動画それぞれ一定数あり
- 広告プラットフォームはFacebookとInstagramの2種類。Facebookが多め

# ユーザー特徴量でのクラスタリングの検証（Ver1.1）
## 🔄 実施内容
- 特徴量に以下を使用
"day_of_week","user_gender","user_age","hour_sin","hour_cos"
"art","fashion","finance","fitness","food","gaming","health","lifestyle","news","photography","sports","technology","travel"
- カテゴリカル変数として"day_of_week","user_gender"をワンホットエンコーディング
- k=5 を仮置きで設定
- 標準化＋PCAで2次元化して分布確認

10/20 追記
- 今回の結果をDBI（デイビス・ボールディン指数）とCH（カリンスキー・ハラバス指数）で評価
    DBI：クラスター間の分離の良さとクラスター内部の密集度のバランスを見る指標
        値が小さいほど良い（基準1.0未満なら許容。0.5未満なら良好）
    CH：クラスター間の分散とクラスター内部の分散の比率を見る指標
        値が大きいほど良い
    シルエットスコアも出したかったが、計算が重いため、今回は割愛
    
- 各クラスターの特徴量を可視化

## ⚙️ 使用データ
- users.csv
- events.csv

## 📊 現状の結果
- PCAのX軸は年齢の影響を強く受けている印象。（X軸のみでクラスタが決定されている状況）
- Y軸はカテゴリカル変数が多すぎて分散している。

10/20 追記
- 評価指標 
    DBI：2.618 のため、評価❌
    CH：26696.857のため、評価🟢
        ⇒クラスタ間の距離も内部の距離も大きいため、上手く分けられていない可能性が高い

- 各クラスタの特徴比較
    標準化したままで出力したため、年齢や時間の影響は読み取りにくいが、以下のことが分かった
    クラスタ0のみ年齢の値が大きい
    クラスタ毎に時刻（hour_sin,cos）の値の差が大きい
    各interestカテゴリの差はあまり見られない
    曜日の差もあまり見られない
    クラスタ0~2は性別差はあまり見られない（大体男性 55%前後、女性 35%前後、その他11%）が、クラスタ3では女性比率が81%、クラスタ4では男性比率が100%となっており、性別による傾向差が見られた
        ⇒年齢、時刻、性別がクラスタ分けに影響している

## 🚧 今後の課題
- カテゴリカル変数のエンコーディング方法を見直して再検証
day_of_week：周期エンコーディング など

- 各クラスタの特徴量確認時に年齢や時刻を標準化前の状態に戻して確認する
- 各クラスタのCTR、CVRも確認する

- 年齢の分布の偏りが大きいので、DBSCANによるクラスタリングも検証

